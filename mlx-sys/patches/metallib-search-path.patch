--- a/mlx/backend/metal/device.cpp
+++ b/mlx/backend/metal/device.cpp
@@ -87,6 +87,28 @@
 }
 #endif

+// pmetal: Check PMETAL_METALLIB_PATH env var (set by pmetal-cli at startup)
+std::pair<MTL::Library*, NS::Error*> load_env_override_library(
+    MTL::Device* device) {
+  const char* env_path = std::getenv("PMETAL_METALLIB_PATH");
+  if (env_path && env_path[0] != '\0') {
+    return load_library_from_path(device, env_path);
+  }
+  return {nullptr, nullptr};
+}
+
+// pmetal: Check ~/.cache/pmetal/lib/mlx.metallib (XDG cache location)
+std::pair<MTL::Library*, NS::Error*> load_user_cache_library(
+    MTL::Device* device) {
+  const char* home = std::getenv("HOME");
+  if (home && home[0] != '\0') {
+    std::string cache_path =
+        std::string(home) + "/.cache/pmetal/lib/mlx.metallib";
+    return load_library_from_path(device, cache_path.c_str());
+  }
+  return {nullptr, nullptr};
+}
+
 // Firstly, search for the metallib in the same path as this binary
 std::pair<MTL::Library*, NS::Error*> load_colocated_library(
     MTL::Device* device,
@@ -134,38 +156,51 @@
 }

 MTL::Library* load_default_library(MTL::Device* device) {
-  NS::Error* error[5];
+  NS::Error* error[7];
   MTL::Library* lib;
+
+  // pmetal: Try env var override first (set by pmetal-cli resolver)
+  std::tie(lib, error[0]) = load_env_override_library(device);
+  if (lib) {
+    return lib;
+  }
+
+  // pmetal: Try user cache directory
+  std::tie(lib, error[1]) = load_user_cache_library(device);
+  if (lib) {
+    return lib;
+  }
+
   // First try the colocated mlx.metallib
-  std::tie(lib, error[0]) = load_colocated_library(device, "mlx");
+  std::tie(lib, error[2]) = load_colocated_library(device, "mlx");
   if (lib) {
     return lib;
   }

-  std::tie(lib, error[1]) = load_colocated_library(device, "Resources/mlx");
+  std::tie(lib, error[3]) = load_colocated_library(device, "Resources/mlx");
   if (lib) {
     return lib;
   }

   // Then try default.metallib in a SwiftPM bundle if we have one
-  std::tie(lib, error[2]) = load_swiftpm_library(device, "default");
+  std::tie(lib, error[4]) = load_swiftpm_library(device, "default");
   if (lib) {
     return lib;
   }

   // Try lo load resources from Framework resources if SwiftPM wrapped as a
   // dynamic framework.
-  std::tie(lib, error[3]) = load_colocated_library(device, "Resources/default");
+  std::tie(lib, error[5]) = load_colocated_library(device, "Resources/default");
   if (lib) {
     return lib;
   }

   // Finally try default_mtllib_path
-  std::tie(lib, error[4]) = load_library_from_path(device, default_mtllib_path);
+  std::tie(lib, error[6]) = load_library_from_path(device, default_mtllib_path);
   if (!lib) {
     std::ostringstream msg;
     msg << "Failed to load the default metallib. ";
-    for (int i = 0; i < 5; i++) {
+    for (int i = 0; i < 7; i++) {
       if (error[i] != nullptr) {
         msg << error[i]->localizedDescription()->utf8String() << " ";
       }
